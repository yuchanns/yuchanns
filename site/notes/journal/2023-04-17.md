---
title: 日志 2023-03-26
---

* 扩容 Ubuntu 虚拟机磁盘容量[[Linux|linux]]
    * 背景：Proxmox 扩容虚拟机 Ubuntu 磁盘容量；
    * 首先在 PVE 的控制台选中对应 VM->Hardware->DiskAction 进行扩容；假设 500G 扩容到 1T ；
    * 无须重启机器，进入到系统中，查看当前的磁盘情况：
        ```bash
        sudo lsblk
        ```
        查看到系统所在的物理盘是 /dev/sda 里的 /dev/sda3 ，并且 /dev/sda 已经变大 并且 /dev/sda 已经变大到 1T 。但是 /dev/sda3 还是原来的大小
    * 使用 `parted` 扩大 /dev/sda3 的容量：
        ```bash
        sudo parted /dev/sda
        # 因为要扩容的是 sda3，所以输入
        (parted) resizepart 3
        # 然后填写要扩充到的容量
        End? [500GB]: 1024GB
        # 查看扩容的布局
        print
        # 按 q 退出
        ```
    * 更新物理卷大小：
        ```bash
        sudo pvresize /dev/sda3
        ```
    * 更新逻辑卷：
        ```bash
        # 查看逻辑卷路径
        sudo lvdisplay
        # 得到例如 /dev/ubuntu-vg/ubuntu-lv
        # 增加 500G
        sudo lvextend -L +500G /dev/ubuntu-vg/ubuntu-lv
        # 刷新
        sudo resize2fs -p /dev/ubuntu-vg/ubuntu-lv
        ```
